<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Wearopia Product Filter</title>
    <link
      rel="stylesheet"
      href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.2/css/all.min.css"
    />
    <link
      href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css"
      rel="stylesheet"
    />
    <style>
      /* 1. CSS Variables - Design Tokens */
      :root {
        --primary-color: #0f6546; /* Deep Green */
        --light-blue: #1e90ff;
        --mid-green: #3cb371;
        --orange-red: #ff4500;
        --dark-navy: #191970;
      }

      /* 2. Filter & Input Styling */
      .filter-container {
        border: 1px solid #e0e0e0;
        padding: 20px;
        border-radius: 8px;
        background: #fff;
      }

      .filter-section-title {
        font-weight: bold;
        color: #343a40;
        margin-bottom: 15px;
        font-size: 1.1rem;
      }

      .price-range-inputs {
        display: flex;
        gap: 10px;
        margin-top: 15px;
        margin-bottom: 25px;
      }

      .price-range-track {
        height: 5px;
        background: #e9ecef;
        border-radius: 5px;
        position: relative;
      }

      .price-range-active {
        height: 5px;
        background-color: var(--primary-color);
        position: absolute;
        border-radius: 5px;
        transition: left 0.2s ease, width 0.2s ease;
      }

      /* 3. Color Swatches */
      .color-circle {
        width: 20px;
        height: 20px;
        border-radius: 50%;
        display: inline-block;
        margin-right: 8px;
        cursor: pointer;
        border: 2px solid transparent;
      }

      .color-blue {
        background-color: var(--light-blue);
      }
      .color-green {
        background-color: var(--mid-green);
      }
      .color-orange {
        background-color: var(--orange-red);
      }
      .color-darkblue {
        background-color: var(--dark-navy);
      }

      .color-item {
        margin-bottom: 8px;
        display: flex;
        align-items: center;
      }

      .active-color {
        border-color: #343a40 !important;
        box-shadow: 0 0 0 2px rgba(0, 0, 0, 0.1);
      }

      /* 4. Bootstrap Overrides */
      .form-check-input:checked {
        background-color: var(--primary-color);
        border-color: var(--primary-color);
      }

      .form-check-input:focus {
        box-shadow: 0 0 0 0.25rem rgba(15, 101, 70, 0.25);
      }

      /* 5. Product Card Styling */
      .custom-card {
        transition: transform 0.2s ease;
      }

      .custom-card:hover {
        transform: translateY(-5px);
      }

      .custom-img {
        height: 220px;
        object-fit: cover;
      }

      /* 6. Footer Styling */
      .custom-footer {
        padding: 50px 0;
        margin-top: 50px;
        border-top: 1px solid #eee;
      }

      .social-icon {
        width: 36px;
        height: 36px;
        line-height: 32px;
        text-align: center;
        transition: background-color 0.3s;
      }

      .social-icon:hover {
        background-color: var(--primary-color);
        color: white !important;
        border-color: var(--primary-color) !important;
      }

      .no-products {
        text-align: center;
        color: #888;
        font-style: italic;
        margin-top: 30px;
      }
    </style>
  </head>

  <body>
    <div class="container-fluid my-4">
      <div class="row">
        <div class="col-md-3">
          <div class="filter-container shadow-sm">
            <h5 class="filter-section-title">Filter By Price</h5>
            <div class="price-range-track">
              <div id="price-range-active" class="price-range-active"></div>
            </div>

            <div class="price-range-inputs">
              <input
                type="number"
                id="min-price"
                class="form-control form-control-sm"
                value="200"
                min="0"
              />
              <input
                type="number"
                id="max-price"
                class="form-control form-control-sm"
                value="1000"
                min="0"
              />
            </div>

            <hr class="my-3" />

            <h5 class="filter-section-title">Filter by size</h5>
            <div class="mb-3">
              <div class="form-check">
                <input
                  class="form-check-input"
                  type="checkbox"
                  value="XS"
                  id="size-xs"
                /><label class="form-check-label" for="size-xs">XS</label>
              </div>
              <div class="form-check">
                <input
                  class="form-check-input"
                  type="checkbox"
                  value="S"
                  id="size-s"
                /><label class="form-check-label" for="size-s">S</label>
              </div>
              <div class="form-check">
                <input
                  class="form-check-input"
                  type="checkbox"
                  value="M"
                  id="size-m"
                /><label class="form-check-label" for="size-m">M</label>
              </div>
              <div class="form-check">
                <input
                  class="form-check-input"
                  type="checkbox"
                  value="L"
                  id="size-l"
                /><label class="form-check-label" for="size-l">L</label>
              </div>
              <div class="form-check">
                <input
                  class="form-check-input"
                  type="checkbox"
                  value="XL"
                  id="size-xl"
                /><label class="form-check-label" for="size-xl">XL</label>
              </div>
              <div class="form-check">
                <input
                  class="form-check-input"
                  type="checkbox"
                  value="XXL"
                  id="size-xxl"
                /><label class="form-check-label" for="size-xxl">XXL</label>
              </div>
            </div>

            <hr class="my-3" />

            <h5 class="filter-section-title">Categories</h5>
            <div class="mb-3">
              <div class="form-check">
                <input
                  class="form-check-input"
                  type="checkbox"
                  value="Jeans"
                  id="cat-jeans"
                /><label class="form-check-label" for="cat-jeans">Jeans</label>
              </div>
              <div class="form-check">
                <input
                  class="form-check-input"
                  type="checkbox"
                  value="Jacket"
                  id="cat-jacket"
                /><label class="form-check-label" for="cat-jacket"
                  >Jacket</label
                >
              </div>
              <div class="form-check">
                <input
                  class="form-check-input"
                  type="checkbox"
                  value="Pullover"
                  id="cat-pullover"
                /><label class="form-check-label" for="cat-pullover"
                  >Pullover</label
                >
              </div>
              <div class="form-check">
                <input
                  class="form-check-input"
                  type="checkbox"
                  value="T-shirt"
                  id="cat-tshirt"
                /><label class="form-check-label" for="cat-tshirt"
                  >T-shirt</label
                >
              </div>
              <div class="form-check">
                <input
                  class="form-check-input"
                  type="checkbox"
                  value="Homewear"
                  id="cat-homewear"
                /><label class="form-check-label" for="cat-homewear"
                  >Homewear</label
                >
              </div>
              <div class="form-check">
                <input
                  class="form-check-input"
                  type="checkbox"
                  value="Perfume"
                  id="cat-perfume"
                /><label class="form-check-label" for="cat-perfume"
                  >Perfume</label
                >
              </div>
              <div class="form-check">
                <input
                  class="form-check-input"
                  type="checkbox"
                  value="Sportwear"
                  id="cat-sportwear"
                /><label class="form-check-label" for="cat-sportwear"
                  >Sportwear</label
                >
              </div>
            </div>

            <hr class="my-3" />

            <h5 class="filter-section-title">Color</h5>
            <div id="color-filter-group">
              <div class="color-item">
                <span
                  class="color-circle color-blue"
                  data-color="Blue"
                  onclick="toggleColor(this)"
                ></span
                >Blue
              </div>
              <div class="color-item">
                <span
                  class="color-circle color-green"
                  data-color="Green"
                  onclick="toggleColor(this)"
                ></span
                >Green
              </div>
              <div class="color-item">
                <span
                  class="color-circle color-orange"
                  data-color="Orange"
                  onclick="toggleColor(this)"
                ></span
                >Orange
              </div>
              <div class="color-item">
                <span
                  class="color-circle color-darkblue"
                  data-color="Dark Blue"
                  onclick="toggleColor(this)"
                ></span
                >Dark Blue
              </div>
            </div>
          </div>
        </div>

        <div class="col-md-9">
          <div id="product-grid" class="row g-4"></div>
          <div id="no-products" class="no-products d-none">
            No matching products found. Please adjust your filters.
          </div>
        </div>
      </div>
    </div>

    <footer
      class="container-fluid bg-white d-flex align-items-center custom-footer"
    >
      <div class="container">
        <div class="row gy-4 gx-5">
          <div class="col-12 col-md-6 col-lg-3">
            <h4 class="fw-bold text-success mb-3 fs-3">Wearopia</h4>
            <p class="text-secondary small mb-4">
              Discover your unique style with our curated collection of modern
              fashion pieces.
            </p>
            <ul class="list-unstyled text-secondary small mb-4">
              <li class="mb-2">
                <i class="fa-solid fa-location-dot me-2"></i>123 Fashion Street,
                Style City, SC 12345
              </li>
              <li class="mb-2">
                <i class="fa-solid fa-phone me-2"></i>+1 (555) 123-STYLE
              </li>
              <li>
                <i class="fa-solid fa-envelope me-2"></i>hello@stylehub.com
              </li>
            </ul>

            <div class="d-flex gap-3">
              <a
                href="#"
                class="d-flex align-items-center justify-content-center border border-secondary rounded-circle text-dark text-decoration-none fs-6 social-icon"
                ><i class="fa-brands fa-facebook-f"></i
              ></a>
              <a
                href="#"
                class="d-flex align-items-center justify-content-center border border-secondary rounded-circle text-dark text-decoration-none fs-6 social-icon"
                ><i class="fa-brands fa-twitter"></i
              ></a>
              <a
                href="#"
                class="d-flex align-items-center justify-content-center border border-secondary rounded-circle text-dark text-decoration-none fs-6 social-icon"
                ><i class="fa-brands fa-instagram"></i
              ></a>
              <a
                href="#"
                class="d-flex align-items-center justify-content-center border border-secondary rounded-circle text-dark text-decoration-none fs-6 social-icon"
                ><i class="fa-brands fa-youtube"></i
              ></a>
            </div>
          </div>

          <div class="col-12 col-md-3 col-lg-3">
            <h5 class="fw-semibold text-black fs-6 mb-3">Quick Links</h5>
            <ul class="list-unstyled text-secondary small">
              <li class="mb-2">New Arrivals</li>
              <li class="mb-2">Best Sellers</li>
              <li class="mb-2">Sale</li>
              <li class="mb-2">Gift Cards</li>
              <li>Style Guide</li>
            </ul>
          </div>

          <div class="col-12 col-md-3 col-lg-3">
            <h5 class="fw-semibold text-black fs-6 mb-3">Customer Care</h5>
            <ul class="list-unstyled text-secondary small">
              <li class="mb-2">Contact Us</li>
              <li class="mb-2">Size Guide</li>
              <li class="mb-2">Shipping & Returns</li>
              <li class="mb-2">Track Your Order</li>
              <li>FAQ</li>
            </ul>
          </div>

          <div class="col-12 col-md-3 col-lg-3">
            <h5 class="fw-semibold text-black fs-6 mb-3">Company</h5>
            <ul class="list-unstyled text-secondary small">
              <li class="mb-2">About Us</li>
              <li class="mb-2">Careers</li>
              <li class="mb-2">Press</li>
              <li class="mb-2">Sustainability</li>
              <li>Investors</li>
            </ul>
          </div>
        </div>
      </div>
    </footer>

    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/js/bootstrap.bundle.min.js"></script>
    <script>
      // --- 1. Product Data (Diverse data retained for testing all filters) ---
      const products = [
        {
          id: 1,
          name: "Luxury Silk Scarf",
          category: "Perfume",
          size: "XS",
          color: "Blue",
          price: 850,
          image: "Images/black hoddie.png",
        },
        {
          id: 2,
          name: "Denim Trench Coat",
          category: "Jacket",
          size: "XXL",
          color: "Green",
          price: 699,
          image: "Images/black hoddie.png",
        },
        {
          id: 3,
          name: "Distressed Slim Jeans",
          category: "Jeans",
          size: "XL",
          color: "Dark Blue",
          price: 499,
          image: "Images/black hoddie.png",
        },
        {
          id: 4,
          name: "Wool Blend Pullover",
          category: "Pullover",
          size: "S",
          color: "Orange",
          price: 259,
          image: "Images/black hoddie.png",
        },
        {
          id: 5,
          name: "Performance Training Tee",
          category: "Sportwear",
          size: "L",
          color: "Blue",
          price: 399,
          image: "Images/black hoddie.png",
        },
        {
          id: 6,
          name: "Lounge Hoodie",
          category: "Homewear",
          size: "M",
          color: "Green",
          price: 199,
          image: "Images/black hoddie.png",
        },
        {
          id: 7,
          name: "Evening Dress",
          category: "Perfume",
          size: "XS",
          color: "Orange",
          price: 950,
          image: "Images/black hoddie.png",
        },
        {
          id: 8,
          name: "Utility Cargo Jacket",
          category: "Jacket",
          size: "XXL",
          color: "Dark Blue",
          price: 599,
          image: "Images/black hoddie.png",
        },
        {
          id: 9,
          name: "Running Leggings",
          category: "Sportwear",
          size: "S",
          color: "Green",
          price: 179,
          image: "Images/black hoddie.png",
        },
        {
          id: 10,
          name: "Pajama Set",
          category: "Homewear",
          size: "XL",
          color: "Blue",
          price: 249,
          image: "Images/black hoddie.png",
        },
        {
          id: 11,
          name: "Cashmere Pullover",
          category: "Pullover",
          size: "L",
          color: "Orange",
          price: 299,
          image: "Images/black hoddie.png",
        },
        {
          id: 12,
          name: "High-Rise Skinny Jeans",
          category: "Jeans",
          size: "M",
          color: "Dark Blue",
          price: 429,
          image: "Images/black hoddie.png",
        },
        {
          id: 13,
          name: "Basic V-Neck Tee",
          category: "T-shirt",
          size: "S",
          color: "Blue",
          price: 89,
          image: "Images/black hoddie.png",
        },
        {
          id: 14,
          name: "Oversized T-shirt",
          category: "T-shirt",
          size: "XL",
          color: "Green",
          price: 129,
          image: "Images/black hoddie.png",
        },
        {
          id: 15,
          name: "Leather Biker Jacket",
          category: "Jacket",
          size: "M",
          color: "Orange",
          price: 799,
          image: "Images/black hoddie.png",
        },
      ];

      // --- 2. DOM Element References and Constants ---
      const minPriceInput = document.getElementById("min-price");
      const maxPriceInput = document.getElementById("max-price");
      const priceRangeActive = document.getElementById("price-range-active");
      const productGrid = document.getElementById("product-grid");
      const noProductsMsg = document.getElementById("no-products");

      const MIN_VISUAL_RANGE = 0;
      const MAX_VISUAL_RANGE = 1000;

      // --- 3. Filtering Helper Functions ---

      /** Retrieves the value of all checked checkboxes within the filter section. */
      function getSelectedCheckboxes() {
        // Use attribute starts with selector for robustness
        return Array.from(
          document.querySelectorAll(
            '.filter-container input[type="checkbox"]:checked'
          )
        ).map((cb) => cb.value);
      }

      /** Retrieves the data-color attribute of all actively selected color circles. */
      function getActiveColors() {
        return Array.from(
          document.querySelectorAll(".color-circle.active-color")
        ).map((c) => c.dataset.color);
      }

      // --- 4. Rendering Logic ---

      /** Renders the filtered products into the product grid. */
      function renderProducts(filteredProducts) {
        productGrid.innerHTML = ""; // Clear previous products

        if (filteredProducts.length === 0) {
          noProductsMsg.classList.remove("d-none");
          return;
        }
        noProductsMsg.classList.add("d-none");

        filteredProducts.forEach((p) => {
          const card = document.createElement("div");
          card.className = "col-12 col-sm-6 col-lg-4";
          card.innerHTML = `
          <div class="card bg-white border border-light rounded-4 shadow-sm overflow-hidden custom-card">
            <img src="${p.image}" class="card-img-top custom-img" alt="${
            p.name
          }">
            <div class="p-3">
              <h5 class="fs-6 fw-medium mb-1 text-dark">${p.name}</h5>
              <div class="d-flex align-items-center mb-2">
                <span class="fw-semibold fs-6 text-dark me-2">$${p.price.toFixed(
                  2
                )}</span>
                <span class="badge text-bg-secondary">${p.size} / ${
            p.color
          }</span>
              </div>
              <button class="btn btn-success rounded-pill w-100 py-2 fw-semibold text-white">Add to Cart</button>
            </div>
          </div>`;
          productGrid.appendChild(card);
        });
      }

      // --- 5. Main Filter Application Logic ---

      /** Filters the global products array based on current UI selections and renders the results. */
      function applyFilters() {
        // 5.1. Get Price Range
        // التأكد من أن minVal لا تقل عن 0 قبل التحويل لعدد صحيح
        let min = Math.max(
          0,
          parseInt(minPriceInput.value) || MIN_VISUAL_RANGE
        );
        let max = Math.max(
          0,
          parseInt(maxPriceInput.value) || MAX_VISUAL_RANGE
        );

        // Ensure min is not greater than max when filtering
        const effectiveMin = Math.min(min, max);
        const effectiveMax = Math.max(min, max);

        // 5.2. Get Checkbox and Color Selections
        const selectedFilters = getSelectedCheckboxes();

        // يتم فصل الفلاتر المختارة إلى مقاسات وفئات
        const allSizes = ["XS", "S", "M", "L", "XL", "XXL"];
        const selectedSizes = selectedFilters.filter((v) =>
          allSizes.includes(v)
        );
        const selectedCategories = selectedFilters.filter(
          (v) => !allSizes.includes(v)
        );
        const selectedColors = getActiveColors();

        // 5.3. Filter the Products Array
        const filtered = products.filter((p) => {
          const passesPrice =
            p.price >= effectiveMin && p.price <= effectiveMax;
          const passesSize =
            selectedSizes.length === 0 || selectedSizes.includes(p.size);
          const passesCategory =
            selectedCategories.length === 0 ||
            selectedCategories.includes(p.category);
          const passesColor =
            selectedColors.length === 0 || selectedColors.includes(p.color);

          return passesPrice && passesSize && passesCategory && passesColor;
        });

        renderProducts(filtered);
      }

      // --- 6. Event Handlers and Initialization ---

      /** Updates the visual price range slider and triggers the main filter function. */
      function updatePriceTrackAndFilters() {
        // هنا أيضاً نضمن أن القيمة لا تقل عن 0
        let minVal = Math.max(
          0,
          parseInt(minPriceInput.value) || MIN_VISUAL_RANGE
        );
        let maxVal = Math.max(
          0,
          parseInt(maxPriceInput.value) || MAX_VISUAL_RANGE
        );

        // يتم إعادة كتابة القيم في الحقول لضمان عدم بقاء أي قيمة سالبة أدخلها المستخدم
        minPriceInput.value = minVal;
        maxPriceInput.value = maxVal;

        // Ensure min is not greater than max (for visual representation)
        if (minVal > maxVal) [minVal, maxVal] = [maxVal, minVal];

        // Clamp values to the visual range
        minVal = Math.max(MIN_VISUAL_RANGE, Math.min(minVal, MAX_VISUAL_RANGE));
        maxVal = Math.min(MAX_VISUAL_RANGE, Math.max(maxVal, MIN_VISUAL_RANGE));

        const totalVisualRange = MAX_VISUAL_RANGE - MIN_VISUAL_RANGE;
        const leftPercent =
          ((minVal - MIN_VISUAL_RANGE) / totalVisualRange) * 100;
        const widthPercent = ((maxVal - minVal) / totalVisualRange) * 100;

        priceRangeActive.style.left = leftPercent + "%";
        priceRangeActive.style.width = widthPercent + "%";

        applyFilters();
      }

      // Function exposed to global scope for HTML onclick
      window.toggleColor = function (element) {
        element.classList.toggle("active-color");
        applyFilters();
      };

      // Add event listeners for price inputs
      minPriceInput.addEventListener("input", updatePriceTrackAndFilters);
      maxPriceInput.addEventListener("input", updatePriceTrackAndFilters);

      // Add event listeners for all checkboxes (size and category)
      document
        .querySelectorAll('.filter-container input[type="checkbox"]')
        .forEach((i) => i.addEventListener("change", applyFilters));

      // Initial load: Render all products and set initial slider position
      document.addEventListener("DOMContentLoaded", () => {
        updatePriceTrackAndFilters();
      });
    </script>
  </body>
</html>
